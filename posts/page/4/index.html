<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | sergem's personal public notebook</title><meta name=keywords content><meta name=description content="Personal public notebook"><meta name=author content="serge-m"><link rel=canonical href=https://serge-m.github.io/posts/><link href=/assets/css/stylesheet.min.6d98a2276d0cb41ef459267b3ff3ef02df70a8f16b70bbc52b20568702bc90cf.css integrity="sha256-bZiiJ20MtB70WSZ7P/PvAt9wqPFrcLvFKyBWhwK8kM8=" rel="preload stylesheet" as=style><link rel=icon href=https://serge-m.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://serge-m.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://serge-m.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://serge-m.github.io/apple-touch-icon.png><link rel=mask-icon href=https://serge-m.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.113.0"><link rel=alternate type=application/rss+xml href=https://serge-m.github.io/posts/index.xml><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-40853494-2","auto"),ga("send","pageview"))</script><meta property="og:title" content="Posts"><meta property="og:description" content="Personal public notebook"><meta property="og:type" content="website"><meta property="og:url" content="https://serge-m.github.io/posts/"><meta property="og:image" content="https://serge-m.github.io/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://serge-m.github.io/papermod-cover.png"><meta name=twitter:title content="Posts"><meta name=twitter:description content="Personal public notebook"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://serge-m.github.io/posts/"}]}</script></head><body class=list id=top><script>window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://serge-m.github.io/ accesskey=h title="Home (Alt + H)">Home</a>
<span class=logo-switches></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://serge-m.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://serge-m.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://serge-m.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://serge-m.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://serge-m.github.io/>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2>Jupyter notebooks on EMR</h2></header><section class=entry-content><p>Explanatory data analysis requires interactive code execution. In case of spark and emr it is very convenient to run the code from jupyter notebooks on a remote cluster. EMR allows installing jupyter on the spark master. In order to do that configure "Applications" field for the emr cluster to contain also jupyter hub. For example:
"Applications": [ { "Name": "Ganglia", "Version": "3.7.2" }, { "Name": "Spark", "Version": "2.4.0" }, { "Name": "Zeppelin", "Version": "0....</p></section><footer class=entry-footer>February 4, 2019&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Jupyter notebooks on EMR" href=https://serge-m.github.io/posts/jupyter-notebooks-on-emr/></a></article><article class=post-entry><header class=entry-header><h2>Spark on a local machine</h2></header><section class=entry-content><p>How to install spark locally Considering spark without hadoop built-in.
Download hadoop unpack to /opt/hadoop/ Download spark without hadoop, unpack to /opt/spark Install java. Set JAVA_HOVE environment variable. For example: export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64 create environment variables required for spark to run. One can put those in .bashrc export HADOOP_HOME=/opt/hadoop export SPARK_DIST_CLASSPATH=$HADOOP_HOME/etc/hadoop/*:$HADOOP_HOME/share/hadoop/common/lib/*:$HADOOP_HOME/share/hadoop/common/*:$HADOOP_HOME/share/hadoop/hdfs/*:$HADOOP_HOME/share/hadoop/hdfs/lib/*:$HADOOP_HOME/share/hadoop/hdfs/*:$HADOOP_HOME/share/hadoop/yarn/lib/*:$HADOOP_HOME/share/hadoop/yarn/*:$HADOOP_HOME/share/hadoop/mapreduce/lib/*:$HADOOP_HOME/share/hadoop/mapreduce/*:$HADOOP_HOME/share/hadoop/tools/lib/* Now you can run pyspark for example:
$ /opt/spark/bin/pyspark Python 2.7.12 (default, Nov 12 2018, 14:36:49) [GCC 5.4.0 20160609] on linux2 Type "help", "copyright", "credits" or "license" for more information....</p></section><footer class=entry-footer>January 30, 2019&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Spark on a local machine" href=https://serge-m.github.io/posts/spark-on-a-local-machine/></a></article><article class=post-entry><header class=entry-header><h2>GPIO controls for Rasbperry Pi</h2></header><section class=entry-content><p>Libraries for GPIO Node JS Python Using RPi.GPIO How to Exit GPIO programs cleanly, avoid warnings and protect your Pi Setting up RPi.GPIO, numbering systems and inputs On using hardware PWM without sudo due to permissions for /dev/gpiomem: discussion General pigpio The library also provides a service. It can be useful if you don’t want to give root access to the client applications and want to control PWM for example....</p></section><footer class=entry-footer>September 23, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to GPIO controls for Rasbperry Pi" href=https://serge-m.github.io/posts/gpio-controls-for-rasbperry-pi/></a></article><article class=post-entry><header class=entry-header><h2>Reducing disk usage in Ubuntu</h2></header><section class=entry-content><p>Here are some recipies to make ubuntu installed on USB drive to work faster.
[1]
[2]
reducing swapping Add these lines to /etc/sysctl.conf, and reboot.
vm.swappiness = 0 vm.dirty_background_ratio = 20 vm.dirty_expire_centisecs = 0 vm.dirty_ratio = 80 vm.dirty_writeback_centisecs = 0 More caching while writting on disk Add noatime,commit=120,… to /etc/fstab entries for / and /home</p></section><footer class=entry-footer>August 16, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Reducing disk usage in Ubuntu" href=https://serge-m.github.io/posts/disk-usage-ubuntu/></a></article><article class=post-entry><header class=entry-header><h2>Spark in Docker with AWS credentials</h2></header><section class=entry-content><p>Running spark in docker container Setting up spark is tricky. Therefore it is useful to try out things locally before deploying to the cluster.
Docker is of a good help here. There is a great docker image to play with spark locally. gettyimages/docker-spark
Examples Running SparkPi sample program (one of the examples from the docs of Spark):
docker run --rm -it -p 4040:4040 gettyimages/spark bin/run-example SparkPi 10 Running a small example with Pyspark:...</p></section><footer class=entry-footer>July 29, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Spark in Docker with AWS credentials" href=https://serge-m.github.io/posts/spark-in-docker-with-aws-credentials/></a></article><article class=post-entry><header class=entry-header><h2>OKRs</h2></header><section class=entry-content><p>We had a production system written by mathematicians, 50 different stakeholders with conflicting targets, five leadership changes during last year, a dozen of microservices, AWS costs of 10 thousands per week,
hole galaxy of legacy databases, cron jobs, Celery, greenlets, … Also, unstable API as a dependency, 10 Gb of text dumps as output, user input without validation, false alarms in monitoring, and two dozen unprotected public endpoints. Not that we needed all that for the work, but once you get locked into a serious agile development, the tendency is to push it as far as you can....</p></section><footer class=entry-footer>July 4, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to OKRs" href=https://serge-m.github.io/posts/okrs/></a></article><article class=post-entry><header class=entry-header><h2>Bokeh in jupyter notebooks for interactive plots</h2></header><section class=entry-content><p>Bokeh is a library for interactive visualization. One can use it in Jupyter notebooks.
Here is the example.
Lets say we have a pandas dataframe with timestamps and some values:
1 2 3 4 5 6 7 8 9 10 import pandas as pd from io import StringIO df = pd.read_csv(StringIO("""timestamp,value 2018-01-01T10:00:00,20 2018-01-01T12:00:00,10 2018-01-01T14:00:00,30 2018-01-02T10:30:00,40 2018-01-02T13:00:00,50 2018-01-02T18:00:40,10 """), parse_dates=["timestamp"]) You can visualize it to a nice graph with zoom, selection, and mouse-over tooltips using the bokeh:...</p></section><footer class=entry-footer>June 20, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Bokeh in jupyter notebooks for interactive plots" href=https://serge-m.github.io/posts/bokeh-example/></a></article><article class=post-entry><header class=entry-header><h2>Comparison of click-based config parsers for python</h2></header><section class=entry-content><p>Problem There is click module that allows you to create comman dline interfaces for your python scripts. The advantages of click are
nice syntax 1 2 3 4 5 6 7 8 9 10 11 12 13 import click @click.command() @click.option('--count', default=1, help='Number of greetings.') @click.option('--name', prompt='Your name', help='The person to greet.') def hello(count, name): """Simple program that greets NAME for a total of COUNT times.""" for x in range(count): click....</p></section><footer class=entry-footer>June 6, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Comparison of click-based config parsers for python" href=https://serge-m.github.io/posts/click-config-parsers/></a></article><article class=post-entry><header class=entry-header><h2>Vim cheat sheet</h2></header><section class=entry-content><p>Some frequently used commands in Vim File explorer :Explore - opens the file explorer window. :E - the same Visual commands > - shift right &lt; - shift left y - yank (copy) marked text d - delete marked text ~ - switch case Cut and Paste yy - yank (copy) a line 2yy - yank 2 lines yw - yank word y$ - yank to end of line p - put (paste) the clipboard after cursor P - put (paste) before cursor dd - delete (cut) a line dw - delete (cut) the current word x - delete (cut) current character Search/Replace /pattern - search for pattern ?...</p></section><footer class=entry-footer>May 31, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Vim cheat sheet" href=https://serge-m.github.io/posts/vim/></a></article><article class=post-entry><header class=entry-header><h2>Select lines matching regular expression in python</h2></header><section class=entry-content><p>Given a text file we want to create another file containing only those lines that match a certain regular expression using python3
1 2 3 4 5 6 import re with open("./in.txt", "r") as input_file, open("out.txt", "w") as output_file: for line in input_file: if re.match("(.*)import(.*)", line): print(line, file=output_file)</p></section><footer class=entry-footer>February 26, 2018&nbsp;·&nbsp;SergeM</footer><a class=entry-link aria-label="post link to Select lines matching regular expression in python" href=https://serge-m.github.io/posts/print-lines-matching-regex/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://serge-m.github.io/posts/page/3/>« Prev Page</a>
<a class=next href=https://serge-m.github.io/posts/page/5/>Next Page »</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://serge-m.github.io/>sergem's personal public notebook</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById("menu").scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById("menu").scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>